Ref: ENVSOFT_2019_470
Title: An Agricultural Water Use Package for MODFLOW and GSFLOW
Journal: Environmental Modelling and Software

Dear Dr. Niswonger,

Thank you for submitting your manuscript to Environmental Modelling and Software. I have received comments from reviewers on your manuscript. Your paper should become acceptable for publication pending suitable minor revision and modification of the article in light of the appended reviewer comments.

When resubmitting your manuscript, please carefully consider all issues mentioned in the reviewers' comments, outline every change made point by point, and provide suitable rebuttals for any comments not addressed.

To submit your revised manuscript:

Log into EVISE® at: http://www.evise.com/evise/faces/pages/navigation/NavController.jspx?JRNL_ACR=ENVSOFT
Locate your manuscript under the header 'My Submissions that need Revisions' on your 'My Author Tasks' view
Click on 'Agree to Revise'
Make the required edits
Click on 'Complete Submission' to approve
I look forward to receiving your revised manuscript as soon as possible.

Kind regards,

Dr Ames
Editor-in-Chief
Environmental Modelling and Software

Comments from the editors and reviewers:
-Reviewer 1

  - This is a well-written manuscript that describes a comprehensive package for MODFLOW that is capable of incorporating agricultural aspects into hydrological modelling. My comments below are very minor (mostly editorial in nature) and refer to line numbers generated by the journal:

L62: capitalize 'Agricultural' ?
L206: 'we' ? - off given this is a single author paper
L208: it would be worthwhile to even loosely quantify what is meant by 'regional-scale'
L353: typo? 'continuity and Manning's equations'
L432: not sure I understand why mapped identifiers would change during a simulation - maybe briefly explain
L648: yellow diversion symbols and grey irrigation wells are tough to see on Figure 1
L2117: the 'Discussion' reads more like a 'Summary' - some more discussion regarding the advancement of new AG package compared to OWHM and FMP2 would be useful - even just a few sentences based on the authors experience

-Reviewer 2

  -
1.) My most significant comment is that the manuscript should provide a detailed comparison of the new AG package to other similar software available for MODFLOW/GSFLOW (and/or other codes), particularly the USGS Farm Process Version 2 (FMP2) [mentioned only briefly at line 180].  According to documentation for FMP2 it fills a very similar role and has a very similar set of capabilities as the AG-package.   It is unclear therefore why the author has decided to create this new package, without further explanation of the different capabilities of AG to FMP2 and how each is applicable to different problems.  This could be in the Introduction and/or the Discussion section.

2.) I would like to see results of AG package compared to other similar codes and the "pre-processing" mentioned in order to provide verification of AG and/or highlight differences in results based on the method used.  

3.) Line 227: Provide explanation of these recent enhancements.  In particular it should be clarified how AG-package can represent changes in land use, as this is a useful capability that is not currently discussed in the manuscript.

4.) General comment (e.g., line 253) - there are so many different codes it may be helpful to have a table that summarizes each, and brief discussion of their capability.  Also, I prefer the term 'code' when discussion a software platform and 'model' for when a code is applied to a specific problem.

5.) Section 4.1.1 - How is irrigation duration/application rate defined?  Application rate can have a significant impact on the amount of runoff generated, for example.  

6.) Line 303: It is not the case that in practice irrigation water is always only diverted from one location, it is often the case that irrigation is provided to one field from multiple locations (diversions, wells, etc).  

7.) Line 372 - this sentence is unclear, please define "open detention storage reservoirs" and clarify if the LAK package is used for this in GSFLOW.

8.) Line 400 - "pumping rates are specified" is inconsistent with the following discussion, because in some cases the pumping rate is not specified but is calculated based on crop demands.  

9.) Line 402 - Please clarify, if the well is used for irrigation then it is not also in the WELL package?  How is a well handled that is used for both irrigation supply and other uses, such as domestic supply (as is fairly common)?

10.) Line 413 - It also occurs that surface water is used as a supplement to a primary groundwater source.  For example, groundwater pumping can be the main supply for irrigation until groundwater levels fall below a certain level or there are other administrative constraints on pumping, at which point the grower will purchase water from a reservoir.  I suggest the Ag-package be updated to allow for this situation, which it apparently currently is not. 

11.) Consider a limitations section that outlines situations where the AG-package is not currently well suited, and how it may be revised in the future.  This may come in part from comparison to the FMP2, and outline capabilities FMP2 has that Ag-package does not.

12.) Line 423, Line 440: 'Cells/HRUs' should be better explained, as in many cases the HRUs are much larger than the groundwater model cells it is unclear what flexibility there is to assign irrigation to either cells OR HRUs for instance.  

13.) Line 440 - That irrigation cannot be applied to only a partial area of an HRU (or model cell in some instances) appears to be a limitation that should be discussed.

14.) Line 452 - Clarify how the priority is established when multiple diversions and/or wells provide water to a single cell.  

15.) Line 479 - Clarify if all climate and vegetation data needed for these ETo calculations are already input in PRMS or if any additional data needs for AG package.

16.) Line 507 - It's unclear if this paper is also providing an update to the UZF package, please clarify.

17.) Line 544 - Return flow can also occur at the place of use, as discussed in the manuscript.

18.) Line 550 - Clarify how deep percolation, including for salt leaching, is handled.  

19.) Line 570 - This paragraph appears to be out of place and should be in the irrigation delivery section.

20.) Section 4.2. Suggest discussion before section 4.2.1 that summarizes each of the three options discussed below, compare/contrast with each other, why user would choose 1 or another in different situations.

21.) Section 4.2. Can more than 1 option be used at the same time for different areas of a model?  

22.) Line 760.  Is there any return-flow generated on runoff caused by a water application rate in excess of soil hydraulic conductivity?

23.) Line 882. Is Option 3 the same as Option 2 if parameters are established such that ETa = KcETo?  If so please state. 

24.) Section 4.2.3.1 - The way this document is organized it appears this section is only applicable to Section 4.2.3, whereas it really is applicable to all of Section 4.2.

25.) Consider combining Section 5 and Section 6, or otherwise retitle Section 5 to clarify that this is only the setup for the Example Problems.  

26.) Line 1214 - Figure number is wrong here and in several places in the manuscript.  

27.) Line 1586 - Unclear how setting a maximum would set this priority, wouldn't it be a minimum in upstream segment?

28.) Line 1875 - Suggest providing a plot of soil moisture over time.  

29.) Line 2045 - This sentence beginning here is confusing with the previous sentence, please clarify and add results from 2a to Figure 10.  It is not intuitively obvious when the differences would be significant and this appears to be a useful outcome from the modeling presented, warranting further explanation.

30. Line 184.  “A common approach for simulating agricultural systems in regional integrated models is to estimate demands as a pre-processing step”. 
In the Farm Package, crop-water demand and total farm delivery requirement are both estimated by the model (Schmid et al., 2006 - Page 8).  The author needs to explain what he means by “estimate demand as a pre-processing step”.

31. Line 293. The Title “4 Methods” is not representative of the content of the Section.  It is not clear what methods are exactly described in the Section.  I suggest adding a paragraph before this Section that explains the structure of the paper and what each subsequent Section of the paper discusses.

32. Line 492.  “Sub-irrigation is simulated by UZF assuming a linear capillary rise as a function of groundwater head”. 

How the sub irrigation is different from Actual Crop ET (ETa) mentioned in Line 464?  I gather that ETa in line 464 is UZF ET but sub irrigation is GW ET.  If this correct, this needs to be explained in terms that are consistent with UZF package documentation.  The term “Sub-irrigation” is not mentioned anywhere in UZF documentation.  This is more of a general comment as the author mentions terms and refer to documents.  However, those terms may be stated with different names on the referenced documents.

33. Lines from 507 through 532.

I gather the new option mentioned here is added to the UZF package and is not relevant to the AG package.  My understanding is that the AG package can be used with the current UZF package or the modified UZF package as described in those lines.  If this correct, I suggest removing those lines altogether as they distract the reader from the main topics of the paper.  If not, better explanations are needed on the relationship between the new option mentioned in those lines and the AG Package.

The whole subsection 4.1.2 seems to be unrelated to AG package.  It discusses how ET is calculated from unsaturated and saturated zones in UZF and PRMS. 

34. Line 684.  “irrigation demand is set using time varying surface water diversions specified in SFR tabfiles, or time varying pumping rates specified in AG”

Does that mean demand is estimated as pre-processing step?  This contradicts the statement in Line 184.

35. Line 752 “FFn is the fraction of the diverted irrigation water that will be applied to cell n”.

How is that determined?  Is it calculated by AG package or is an input to the model?  Does the sum of FFn in all cells irrigated by a diversion or groundwater well needs to equal 1.0?

36. Should Equation 6 read Qreturn = (1-EFSW) QSW + (1-EFGW) Qsup?  or Qreturn = (1-EFGW) QGW


37. Line 772 “If efficiency factors are used to represent crop consumption (EFSW and EFSW > 0), then ET should be made zero in UZF/PRMS cells/HRUs that contain fields”.

There is typo in this sentence; it should be EFGW and EFSW > 0.

Also, it is not clear how the ET should be made zero in UZF/PRMS.  How will this affect parameter values in UZF/PRMS.  Actual parameter names (as referenced in UZF and PRMS documentations) that should be made zero need to be identified (e.g., PET at cells contain fields in UZF should be made zero).

38. Lines 829, 833 “dimension L3/T-1”.  It should read L3/T or L3T-1.  A global search is needed as L3/T-1 seem to be stated throughout the document.


39. Terms in Equations 10 and 11

I think it is worth mentioning in the explanation of terms in Equations 10 and 11 that ETa is the UZF ET (calculated by UZF package) or ET calculated by PRMS.  It is worth mentioning too that Kc ET0 in Equation 11 is PET in UZF package.  As mentioned in earlier comment, better attempt is needed to explain the link between AG package with existing UZF, SFR, and PRMS.  Such links can be made with the same parameter names and symbols in the paper as used in the respective documents.  These terms seem to be explained in Equation 14 but I think it better be explained the first time they are mentioned.

40. Line 845 “where is the Tirr and TPeriod are ...”

Remove the word “is”.

Also, on Equation 12, shouldn’t it be Tirr = TPeriod

Is TPeriod an input to the AG Package?  Should irrigation be on for only the specified TPerio, making the sign “=” is more appropriate than “³”.  If this is not the case, better explanation is needed for equation 12. 

41. It is not clear what is the difference between Equations 11 and 15 (i.e. Qsum and QET, ww).

42. Figure 2-A.  more explanation is needed in the figure.

For example, ETa is calculated by AG using efficiency factor ETa = eff*Irr

Irr = (Qsw + Qgw)/A

It is implied from the figure that demand is always SFR diversions specified in SFR tabfiles.  This is not always the case.  For the avoidance of confusion, it is better to stick with the definition of the demand as in line 712 (i.e., volumetric rate for the irrigation period required for crop growth).  Definition of demand as SFR input diversion may be implied throughout the document.  I think such definition needs to be avoided. 

43. Line 1369.  Each stress period represents a calendar month and are (is) divided into daily...

44. Line 1382.  Monthly ETww was specified in the UZF input file (as variable PET). 

45. Line 1403.  ...using equation 15.  Shouldn’t be Equation 16?

46. Line 1405.  ...Segment number 9.  Shouldn’t Segment number 6?

47. Line 1411.  Example Problem 2: GSFLOW-Conjunctive use of SW and GW, ETDEMAND verses (versus) TRIGGER options

48. Better discussion is needed for Figures 6 and 7.  For example, why the ETa seem to equal sum of SW diversion and SUP Pumping.  Shouldn’t be sum of SW diversion and SUP pumping be greater than ETa because of return flow? Why Cumulative crop consumption equals cumulative fine soil?

